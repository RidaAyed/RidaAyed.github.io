<!DOCTYPE html>
<html lang="">

<head>
  <meta charset="utf-8">

<meta name="viewport" content="width=device-width, initial-scale=1.0">


  
    
  








<meta name="generator" content="Hugo 0.73.0" />
  <title>rida.ayed</title>
  <link rel="canonical" href="/">


  <link rel="alternate" type="application/rss+xml" href="/index.xml" title="rida.ayed">

  








  

  

  

  
    
    
    
    
    
  
    
    
    
      
      
    
    
    
  
    
    
    
      
      
    
    
    
  
    
    
    
      
      
    
    
    
  
    
    
    
      
      
    
    
    
  
    
    
    
      
      
    
    
    
  
    
    
    
      
      
    
    
    
  
    
    
    
      
      
    
    
    
  
    
    
    
      
      
    
    
    
  

  


  
  <link rel="stylesheet" href="/css/base.min.b94428eebe75e333d88818267f7dd5e1598fb5e021bc7219b8b991e1559b3723.css" integrity="sha256-uUQo7r514zPYiBgmf33V4VmPteAhvHIZuLmR4VWbNyM=" crossorigin="anonymous">



</head>

<body>
  <nav class="u-background">
  <div class="u-wrapper">
    <ul class="Banner">
      <li class="Banner-item Banner-item--title">
        <a class="Banner-link u-clickable" href="/">rida.ayed</a>
      </li>
      
        <li class="Banner-item">
          <a class="Banner-link u-clickable" href="/posts/">Posts</a>
        </li>
      
        <li class="Banner-item">
          <a class="Banner-link u-clickable" href="/index.xml">RSS</a>
        </li>
      
    </ul>
  </div>
</nav>
  <main>
    <div class="u-wrapper">
      <div class="u-padding">
        

  

  
    <article>
      <header class="Heading">
  <h2 class="Heading-title">
    <a class="Heading-link u-clickable" href="/posts/test_offline_and_fast_with_python_pytest/" rel="bookmark">Test offline and fast with python pytest</a>
  </h2>
  
    <time datetime="2020-04-04T11:03:00&#43;02:00">4 April, 2020</time>
  
</header>
      
        <!-- raw HTML omitted -->
<!-- raw HTML omitted -->
<ul>
<li><a href="#motivation">Motivation</a></li>
<li><a href="#requirements">Requirements</a></li>
<li><a href="#create-the-test">Create the test</a></li>
<li><a href="#run-the-test">Run the test</a></li>
<li><a href="#check-folders-and-files">Check folders and files</a></li>
<li><a href="#go-offline">Go offline</a></li>
<li><a href="#run-the-test-again-offline">Run the test again - offline</a></li>
<li><a href="#go-back-online">Go back online</a></li>
<li><a href="#conclusion">Conclusion</a></li>
</ul>
<!-- raw HTML omitted -->
<h2 id="motivation">Motivation</h2>
<p>While testing code against online sources like websites or APIs I often find
myself waiting for their responses. Furthermore it feels strange to knock on anyones
door every couple of seconds just to test what I&rsquo;m processing locally anyway.</p>
<p>A solution for this issues comes in the form of <a href="https://vcrpy.readthedocs.io/">vcrpy</a>.</p>
<p>Vcrpy frees you from the burden of waiting or even to be online at all. Responses are stored locally in the form of yaml files called cassettes.</p>
<p>In the following post I&rsquo;ll test against Migros&rsquo; mobile plan named M-Budget. Migros is among Switzerland&rsquo;s largest wholesale retailers.</p>
<p>The test consists of asserting a word&rsquo;s appearance on Migros&rsquo; website.</p>
<h2 id="requirements">Requirements</h2>
<p>Python</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-sh" data-lang="sh">python --version
</code></pre></div><div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-text" data-lang="text">Python 3.8.1
</code></pre></div><p>Module</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-sh" data-lang="sh">pip install --user pytest
pip install --user pytest-vcr
</code></pre></div><h2 id="create-the-test">Create the test</h2>
<div class="highlight"><div style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4">
<table style="border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 1
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 2
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 3
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 4
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 5
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 6
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 7
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 8
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 9
</span><span style="display:block;width:100%;background-color:#3c3d38"><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">10
</span></span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">11
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">12
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">13
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">14
</span><span style="display:block;width:100%;background-color:#3c3d38"><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">15
</span></span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#75715e"># content of ~/tmp/vhs/test_mbudget.py</span>
<span style="color:#f92672">import</span> os
<span style="color:#f92672">import</span> urllib.request
<span style="color:#f92672">import</span> pytest


<span style="color:#a6e22e">@pytest.fixture</span>(scope<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;module&#39;</span>)
<span style="color:#66d9ef">def</span> <span style="color:#a6e22e">vcr_cassette_dir</span>(request):
    <span style="color:#75715e"># Put all cassettes in ~/tmp/vhs/{module}/{test}.yaml</span>
<span style="display:block;width:100%;background-color:#3c3d38">    <span style="color:#66d9ef">return</span> os<span style="color:#f92672">.</span>path<span style="color:#f92672">.</span>join(<span style="color:#e6db74">&#39;/home/ra/tmp/vhs&#39;</span>, request<span style="color:#f92672">.</span>module<span style="color:#f92672">.</span>__name__)
</span>
<span style="color:#a6e22e">@pytest.mark.vcr</span>()
<span style="color:#66d9ef">def</span> <span style="color:#a6e22e">test_mbudget</span>():
    response <span style="color:#f92672">=</span> urllib<span style="color:#f92672">.</span>request<span style="color:#f92672">.</span>urlopen(<span style="color:#e6db74">&#39;https://selfcare.m-budget.migros.ch/eCare/de/users/sign_in&#39;</span>)<span style="color:#f92672">.</span>read()
<span style="display:block;width:100%;background-color:#3c3d38">    <span style="color:#66d9ef">assert</span> <span style="color:#e6db74">b</span><span style="color:#e6db74">&#39;csrf-token&#39;</span> <span style="color:#f92672">in</span> response</span></code></pre></td></tr></table>
</div>
</div>
<p>Line 10 says we want our cassetes saved in <em>home/ra/tmp/vhs/test_mbudget</em></p>
<p>Line 15 asserts the appearance of the word &lsquo;csrf-token&rsquo; in the requested website&rsquo;s source</p>
<h2 id="run-the-test">Run the test</h2>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-sh" data-lang="sh">pytest ~/tmp/vhs/test_mbudget.py
</code></pre></div><div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-text" data-lang="text">============================= test session starts ==============================
platform linux -- Python 3.8.1, pytest-5.3.5, py-1.8.1, pluggy-0.13.1
rootdir: /home/ra
plugins: vcr-1.0.2, pycharm-0.5.0
collected 1 item

../tmp/vhs/test_mbudget.py .                                             [100%]

============================== 1 passed in 11.40s ==============================
</code></pre></div><p>Note the time the test needed to pass: <strong>11.40s</strong></p>
<h2 id="check-folders-and-files">Check folders and files</h2>
<h3 id="check-the-newly-created-cassettes-folder">Check the newly created cassettes folder</h3>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-sh" data-lang="sh">tree ~/tmp/vhs/
</code></pre></div><div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-text" data-lang="text">/home/ra/tmp/vhs/
├── __pycache__
│   └── test_mbudget.cpython-38-pytest-5.3.5.pyc
├── test_mbudget
│   └── test_mbudget.yaml
└── test_mbudget.py

2 directories, 3 files
</code></pre></div><h3 id="check-the-created-file">Check the created file</h3>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-sh" data-lang="sh">cat ~/tmp/vhs/test_mbudget/test_mbudget.yaml | grep <span style="color:#e6db74">&#39;csrf-token&#39;</span>
</code></pre></div><div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-text" data-lang="text">/&gt;\n&lt;meta name=\&#34;csrf-token\&#34; content=\&#34;wtwue7j8wcWPZEw2iI3aJtohGxfN9iSMVlGdbf4kUyT31iupUO2EyJ2i/aZA8z+LHclUsYBbH+HTrScrIaxGyg==\&#34;
</code></pre></div><h2 id="go-offline">Go offline</h2>
<p>Let&rsquo;s disable our network connection</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-sh" data-lang="sh">sudo ip link set wlp3s0 down
</code></pre></div><h2 id="run-the-test-again-offline">Run the test again - offline</h2>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-sh" data-lang="sh">pytest ~/tmp/vhs/test_mbudget.py
</code></pre></div><div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-text" data-lang="text">============================= test session starts ==============================
platform linux -- Python 3.8.1, pytest-5.3.5, py-1.8.1, pluggy-0.13.1
rootdir: /home/ra
plugins: vcr-1.0.2, pycharm-0.5.0
collected 1 item

../tmp/vhs/test_mbudget.py .                                             [100%]

============================== 1 passed in 0.05s ===============================
</code></pre></div><p>Note how much faster <strong>(0.05s)</strong> the test ran and we&rsquo;re <code>offline</code>.</p>
<h2 id="go-back-online">Go back online</h2>
<p>Mind to re-enable your network connection</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-sh" data-lang="sh">sudo ip link set wlp3s0 up
</code></pre></div><h2 id="conclusion">Conclusion</h2>
<p>We were able to reduce waiting from 11 seconds to 0.5 seconds (you&rsquo;re already
doing the ratio math in your head, right?). Furthermore we&rsquo;re able to
continue our development offline and aren&rsquo;t bothering anyone with countless
requests.</p>
<p>Or simply quoting vcrpy&rsquo;s unique selling propositions:</p>
<blockquote>
<ul>
<li>The ability to work offline</li>
<li>Completely deterministic tests</li>
<li>Increased test execution speed</li>
</ul>
</blockquote>

      
      


  

  





  <footer>
    
      
    
      
        <ul class="Tags">
          
            <li class="Tags-item u-background">
              <a class="Tags-link u-clickable" href="/tags/pytest/" rel="tag">pytest</a>
            </li>
          
            <li class="Tags-item u-background">
              <a class="Tags-link u-clickable" href="/tags/python/" rel="tag">python</a>
            </li>
          
        </ul>
      
    
  </footer>

    </article>
    
      <div class="Divider"></div>
    
  
    <article>
      <header class="Heading">
  <h2 class="Heading-title">
    <a class="Heading-link u-clickable" href="/posts/mount_a_usb_drive_persistently_for_all_users/" rel="bookmark">Mount a USB drive persistently for all users</a>
  </h2>
  
    <time datetime="2020-03-28T12:50:00&#43;01:00">28 March, 2020</time>
  
</header>
      
        <!-- raw HTML omitted -->
<!-- raw HTML omitted -->
<ul>
<li><a href="#create-a-mount-point">Create a mount point</a></li>
<li><a href="#list-devices">List devices</a></li>
<li><a href="#backup-and-print-current-fstab">Backup &amp; print current fstab</a></li>
<li><a href="#add-the-device-to-fstab">Add the device to fstab</a></li>
<li><a href="#change-device-s-permission">Change device&rsquo;s permission</a></li>
<li><a href="#test">Test</a></li>
<li><a href="#cleanup">Cleanup</a></li>
<li><a href="#troubleshooting">Troubleshooting</a></li>
</ul>
<!-- raw HTML omitted -->
<p>I need to persistently permit all users read/write access to a USB drive</p>
<h2 id="create-a-mount-point">Create a mount point</h2>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-sh" data-lang="sh">mkdir /mnt/usb500
</code></pre></div><h2 id="list-devices">List devices</h2>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-sh" data-lang="sh">lsblk -o NAME,FSTYPE,LABEL
</code></pre></div><div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-text" data-lang="text">NAME        FSTYPE LABEL
sda
└─sda1      ext4   usb500gb
mmcblk0
├─mmcblk0p1 vfat   boot
└─mmcblk0p2 ext4   rootfs
</code></pre></div><h2 id="backup-and-print-current-fstab">Backup &amp; print current fstab</h2>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-sh" data-lang="sh">cp /etc/fstab ~/fstab.bak
cat /etc/fstab
</code></pre></div><div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-text" data-lang="text">proc            /proc           proc    defaults          0       0
PARTUUID=45eaad39-01  /boot           vfat    defaults          0       2
PARTUUID=45eaad39-02  /               ext4    defaults,noatime  0       1
</code></pre></div><h2 id="add-the-device-to-fstab">Add the device to fstab</h2>
<p>Hint: <code>nofail</code> do not report errors for this device if it does not exist. You
may boot without the drive.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-sh" data-lang="sh">echo <span style="color:#e6db74">&#34;\n/dev/sda1    /mnt/usb500  ext4   user,rw,nofail&#34;</span> &gt;&gt; /etc/fstab
</code></pre></div><h2 id="change-device-s-permission">Change device&rsquo;s permission</h2>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-sh" data-lang="sh">mount -a
sudo chmod <span style="color:#ae81ff">777</span> /mnt/usb500/
</code></pre></div><h2 id="test">Test</h2>
<h3 id="reboot">Reboot</h3>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-sh" data-lang="sh">sudo reboot
</code></pre></div><h3 id="write-into-a-temporary-file">Write into a temporary file</h3>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-sh" data-lang="sh">cd /mnt/usb500/
echo <span style="color:#e6db74">&#39;foo&#39;</span> &gt; bar.txt
cat bar.txt
rm bar.txt
</code></pre></div><div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-text" data-lang="text">foo
</code></pre></div><h2 id="cleanup">Cleanup</h2>
<p>After you thoroughly tested everything remove leftovers</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-sh" data-lang="sh">rm ~/fstab.bak
</code></pre></div><h2 id="troubleshooting">Troubleshooting</h2>
<p>You attached the drive <strong>after booting</strong></p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-sh" data-lang="sh">sudo mount -a
</code></pre></div>
      
      


  

  





  <footer>
    
      
    
      
        <ul class="Tags">
          
            <li class="Tags-item u-background">
              <a class="Tags-link u-clickable" href="/tags/storage/" rel="tag">storage</a>
            </li>
          
        </ul>
      
    
  </footer>

    </article>
    
      <div class="Divider"></div>
    
  
    <article>
      <header class="Heading">
  <h2 class="Heading-title">
    <a class="Heading-link u-clickable" href="/posts/backup_iphone_linux/" rel="bookmark">Backup an iPhone with Linux</a>
  </h2>
  
    <time datetime="2020-03-21T20:35:00&#43;01:00">21 March, 2020</time>
  
</header>
      
        <!-- raw HTML omitted -->
<!-- raw HTML omitted -->
<ul>
<li><a href="#install-the-necessary-packages--posts-connect-iphone-to-raspi-dot-md">Install the necessary packages</a></li>
<li><a href="#find-the-event-iphone-connected">Find the event <code>iPhone connected</code></a></li>
<li><a href="#catch-the-event-iphone-connected">Catch the event <code>iPhone connected</code></a></li>
<li><a href="#create-the-trigger-iphone-connected">Create the trigger <code>iPhone connected</code></a></li>
<li><a href="#create-the-action-backup-iphone">Create the action <code>Backup iPhone</code></a></li>
<li><a href="#restart-and-reload-all-actors--not-the-iphone-though">Restart and reload all actors (not the iPhone though)</a></li>
<li><a href="#monitor-the-backup-process">Monitor the backup process</a></li>
</ul>
<!-- raw HTML omitted -->
<p>This is a follow-up on <a href="/posts/connect_iphone_to_raspi/">Connect an iPhone to a Raspi</a>.</p>
<h2 id="install-the-necessary-packages--posts-connect-iphone-to-raspi-dot-md"><a href="/posts/connect_iphone_to_raspi/#install-the-necessary-packages">Install the necessary packages</a></h2>
<h2 id="find-the-event-iphone-connected">Find the event <code>iPhone connected</code></h2>
<ol>
<li>Connect your iPhone:</li>
<li>Run this script:</li>
</ol>
<!-- raw HTML omitted -->
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-sh" data-lang="sh">lsusb | grep iPhone
</code></pre></div><div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-text" data-lang="text">Bus 001 Device 007: ID 05ac:12a8 Apple, Inc. iPhone5/5C/5S/6
</code></pre></div><h2 id="catch-the-event-iphone-connected">Catch the event <code>iPhone connected</code></h2>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-sh" data-lang="sh"><span style="color:#75715e"># Content of /etc/udev/rules.d/99-iphone.rules</span>
SUBSYSTEM<span style="color:#f92672">==</span><span style="color:#e6db74">&#34;usb&#34;</span>, ENV<span style="color:#f92672">{</span>DEVTYPE<span style="color:#f92672">}==</span><span style="color:#e6db74">&#34;usb_device&#34;</span>, ENV<span style="color:#f92672">{</span>PRODUCT<span style="color:#f92672">}==</span><span style="color:#e6db74">&#34;5ac/12[9a][0-9a-f]/*&#34;</span>, ACTION<span style="color:#f92672">==</span><span style="color:#e6db74">&#34;add&#34;</span>, ENV<span style="color:#f92672">{</span>SYSTEMD_WANTS<span style="color:#f92672">}=</span><span style="color:#e6db74">&#34;iphone-connect.service&#34;</span>
</code></pre></div><h2 id="create-the-trigger-iphone-connected">Create the trigger <code>iPhone connected</code></h2>
<p><!-- raw HTML omitted --><!-- raw HTML omitted --></p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-sh" data-lang="sh"><span style="color:#75715e">#Content of /etc/systemd/system/iphone-connect.service</span>
<span style="color:#f92672">[</span>Service<span style="color:#f92672">]</span>
Type<span style="color:#f92672">=</span>oneshot
ExecStart<span style="color:#f92672">=</span>/bin/sh /home/pi/scripts/backup_iphone.sh
</code></pre></div><h2 id="create-the-action-backup-iphone">Create the action <code>Backup iPhone</code></h2>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-sh" data-lang="sh"><span style="color:#75715e"># Content of ~/scripts/backup_iphone.sh</span>
src<span style="color:#f92672">=</span>/mnt/iphone/ <span style="color:#75715e">#Must exist in prior</span>
dst<span style="color:#f92672">=</span>/media/pi/usb500gb <span style="color:#75715e">#Must exist in prior</span>
log<span style="color:#f92672">=</span>/home/pi/backup_iphone.log
sleep <span style="color:#ae81ff">5</span>
ifuse $src <span style="color:#f92672">&amp;&amp;</span>
    rsync --verbose --archive --compress --update --log-file<span style="color:#f92672">=</span>$log $src $dst
</code></pre></div><h2 id="restart-and-reload-all-actors--not-the-iphone-though">Restart and reload all actors (not the iPhone though)</h2>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-sh" data-lang="sh">sudo udevadm control --reload-rules <span style="color:#f92672">&amp;&amp;</span> udevadm trigger
service udev restart
systemctl daemon-reload <span style="color:#75715e">#THIS one is crucial</span>
</code></pre></div><h2 id="monitor-the-backup-process">Monitor the backup process</h2>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-sh" data-lang="sh">journalctl -f --unit<span style="color:#f92672">=</span>iphone-connect.service --output<span style="color:#f92672">=</span>cat
</code></pre></div>
      
      


  

  





  <footer>
    
      
    
      
        <ul class="Tags">
          
            <li class="Tags-item u-background">
              <a class="Tags-link u-clickable" href="/tags/systemd/" rel="tag">systemd</a>
            </li>
          
            <li class="Tags-item u-background">
              <a class="Tags-link u-clickable" href="/tags/udev/" rel="tag">udev</a>
            </li>
          
            <li class="Tags-item u-background">
              <a class="Tags-link u-clickable" href="/tags/backup/" rel="tag">backup</a>
            </li>
          
        </ul>
      
    
  </footer>

    </article>
    
      <div class="Divider"></div>
    
  
    <article>
      <header class="Heading">
  <h2 class="Heading-title">
    <a class="Heading-link u-clickable" href="/posts/change_firefox_zoom_by_script/" rel="bookmark">Change Firefox&#39;s zoom by script</a>
  </h2>
  
    <time datetime="2020-03-14T16:55:00&#43;01:00">14 March, 2020</time>
  
</header>
      
        <p>Each time I change the monitor I have to zoom in or out firefox. Here&rsquo;s how to set it via script:</p>
<figure>
    <img src="/ox-hugo/2020-03-17_17-41-10_screenshot.png"
         alt="Figure 1: Large"/> <figcaption>
            <p>Figure 1: Large</p>
        </figcaption>
</figure>

<figure>
    <img src="/ox-hugo/2020-03-17_17-43-03_screenshot.png"
         alt="Figure 2: Small"/> <figcaption>
            <p>Figure 2: Small</p>
        </figcaption>
</figure>

<p>Locate the appropriate file</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-sh" data-lang="sh">ls /home/*/.mozilla/firefox/*/prefs.js
</code></pre></div><p>Locate the appropriate parameter</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-sh" data-lang="sh">grep layout.css.devPixelsPerPx /home/*/.mozilla/firefox/*/prefs.js
</code></pre></div><p>Large screen: Set the zoom</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-sh" data-lang="sh"><span style="color:#75715e">#!/usr/bin/env bash
</span><span style="color:#75715e"></span>factor<span style="color:#f92672">=</span>2.5
<span style="color:#66d9ef">if</span> grep <span style="color:#e6db74">&#39;layout.css.devPixelsPerPx&#39;</span> /home/*/.mozilla/firefox/*/prefs.js
<span style="color:#66d9ef">then</span>
    sed -i -e <span style="color:#e6db74">&#34;s/^user_pref(\&#34;layout.css.devPixelsPerPx.*</span>$<span style="color:#e6db74">/user_pref(\&#34;layout.css.devPixelsPerPx\&#34;, \&#34;</span>$factor<span style="color:#e6db74">\&#34;);/&#34;</span> /home/*/.mozilla/firefox/*/prefs.js
<span style="color:#66d9ef">else</span>
    echo <span style="color:#e6db74">&#34;user_pref(\&#34;layout.css.devPixelsPerPx\&#34;, \&#34;</span>$factor<span style="color:#e6db74">\&#34;);&#34;</span> &gt;&gt; /home/*/.mozilla/firefox/*/prefs.js
<span style="color:#66d9ef">fi</span>
</code></pre></div><p>Small screen: Set the zoom</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-sh" data-lang="sh"><span style="color:#75715e">#!/usr/bin/env bash
</span><span style="color:#75715e"></span>factor<span style="color:#f92672">=</span>1.0
<span style="color:#66d9ef">if</span> grep <span style="color:#e6db74">&#39;layout.css.devPixelsPerPx&#39;</span> /home/*/.mozilla/firefox/*/prefs.js
<span style="color:#66d9ef">then</span>
    sed -i -e <span style="color:#e6db74">&#34;s/^user_pref(\&#34;layout.css.devPixelsPerPx.*</span>$<span style="color:#e6db74">/user_pref(\&#34;layout.css.devPixelsPerPx\&#34;, \&#34;</span>$factor<span style="color:#e6db74">\&#34;);/&#34;</span> /home/*/.mozilla/firefox/*/prefs.js
<span style="color:#66d9ef">else</span>
    echo <span style="color:#e6db74">&#34;user_pref(\&#34;layout.css.devPixelsPerPx\&#34;, \&#34;</span>$factor<span style="color:#e6db74">\&#34;);&#34;</span> &gt;&gt; /home/*/.mozilla/firefox/*/prefs.js
<span style="color:#66d9ef">fi</span>
</code></pre></div><p>Make the scripts executable</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-sh" data-lang="sh">sudo chmod --verbose +x ~/src/scripts/FirefoxZoomIn.sh
sudo chmod --verbose +x ~/src/scripts/FirefoxZoomOut.sh
</code></pre></div><div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-sh" data-lang="sh">~/src/scripts/FirefoxZoomIn.sh
</code></pre></div><div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-sh" data-lang="sh">~/src/scripts/FirefoxZoomOut.sh
</code></pre></div><p>Docking/undocking triggers those scripts, which I&rsquo;m handling with <a href="https://wiki.archlinux.org/index.php/Xrandr#Automatically%5Fswitch%5Fconfigurations%5Fwith%5Fautorandr">Autorandr</a>.</p>

      
      


  

  





    </article>
    
      <div class="Divider"></div>
    
  
    <article>
      <header class="Heading">
  <h2 class="Heading-title">
    <a class="Heading-link u-clickable" href="/posts/connect_iphone_to_raspi/" rel="bookmark">Connect an iPhone to a Raspi</a>
  </h2>
  
    <time datetime="2020-01-21T13:10:00&#43;01:00">21 January, 2020</time>
  
</header>
      
        <!-- raw HTML omitted -->
<!-- raw HTML omitted -->
<ul>
<li><a href="#unlock-your-iphone">Unlock your iPhone</a></li>
<li><a href="#connect-and-login-into-your-raspi">Connect and login into your raspi</a></li>
<li><a href="#update-retrieve-new-lists-of-packages">Update - Retrieve new lists of packages</a></li>
<li><a href="#upgrade-perform-an-upgrade">Upgrade - Perform an upgrade</a></li>
<li><a href="#install-the-necessary-packages">Install the necessary packages</a></li>
<li><a href="#connect-the-iphone-with-the-raspi-via-usb">Connect the iPhone with the raspi via USB</a></li>
<li><a href="#accept-the-trust-dialog-on-the-iphone">Accept the trust dialog on the iPhone</a></li>
<li><a href="#pair-the-phone">Pair the phone</a></li>
<li><a href="#accept-another-trust-dialog-the-on-the-iphone">Accept another trust dialog the on the iPhone</a></li>
<li><a href="#create-a-mount-folder">Create a mount folder</a></li>
<li><a href="#mount-the-iphone">Mount the iPhone</a></li>
<li><a href="#approve-success">Approve success</a></li>
<li><a href="#summary-of-all-commands-to-copy-paste">Summary of all commands to copy/paste</a></li>
</ul>
<!-- raw HTML omitted -->
<p>Environment:</p>
<ul>
<li>iPhone 5SE iOS 11.0.1 (15A402)</li>
<li>Raspberry Pi 3 (4.19.66-v7+)</li>
</ul>
<p>Most of the steps below are a gist of this blog post<sup id="fnref:1"><a href="#fn:1" class="footnote-ref" role="doc-noteref">1</a></sup></p>
<h2 id="unlock-your-iphone">Unlock your iPhone</h2>
<p>Unlock/Enter the pass-code (in case you have one) on your iPhone in order to
avoid errors.</p>
<h2 id="connect-and-login-into-your-raspi">Connect and login into your raspi</h2>
<p>Existence of an entry &lsquo;Host raspi&rsquo; in ~/.ssh/config is assumed:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-sh" data-lang="sh">ssh raspi
</code></pre></div><h2 id="update-retrieve-new-lists-of-packages">Update - Retrieve new lists of packages</h2>
<p><!-- raw HTML omitted --><!-- raw HTML omitted --></p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-sh" data-lang="sh">sudo apt-get update
</code></pre></div><h2 id="upgrade-perform-an-upgrade">Upgrade - Perform an upgrade</h2>
<p><!-- raw HTML omitted --><!-- raw HTML omitted --></p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-sh" data-lang="sh">sudo apt-get upgrade
</code></pre></div><h2 id="install-the-necessary-packages">Install the necessary packages</h2>
<p><!-- raw HTML omitted --><!-- raw HTML omitted --></p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-sh" data-lang="sh">sudo apt-get install libimobiledevice-utils
</code></pre></div><p><!-- raw HTML omitted --><!-- raw HTML omitted --></p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-sh" data-lang="sh">sudo apt-get install usbmuxd
</code></pre></div><p><!-- raw HTML omitted --><!-- raw HTML omitted --></p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-sh" data-lang="sh">sudo apt-get install ifuse
</code></pre></div><h2 id="connect-the-iphone-with-the-raspi-via-usb">Connect the iPhone with the raspi via USB</h2>
<h2 id="accept-the-trust-dialog-on-the-iphone">Accept the trust dialog on the iPhone</h2>
<figure><a href="/ox-hugo/2020-03-19_17-06-54_screenshot.png">
    <img src="Access_iphone_data_on_Raspi_via_USB/2020-03-19_15-40-54_screenshot.png"/> </a>
</figure>

<h2 id="pair-the-phone">Pair the phone</h2>
<p><!-- raw HTML omitted --><!-- raw HTML omitted --></p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-sh" data-lang="sh">idevicepair pair
</code></pre></div><div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-text" data-lang="text">SUCCESS: Paired with device 3b9...
</code></pre></div><div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-text" data-lang="text">ERROR: Please accept the trust dialog on the screen of device 3b9...
, then attempt to pair again.
</code></pre></div><h2 id="accept-another-trust-dialog-the-on-the-iphone">Accept another trust dialog the on the iPhone</h2>
<figure>
    <img src="/ox-hugo/2020-03-19_16-50-59_screenshot.png"/> 
</figure>

<h2 id="create-a-mount-folder">Create a mount folder</h2>
<p><!-- raw HTML omitted --><!-- raw HTML omitted --></p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-sh" data-lang="sh">sudo mkdir /mnt/iphone/ --verbose
</code></pre></div><div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-text" data-lang="text">mkdir: mkdir: created directory &#39;/mnt/iphone/&#39;
</code></pre></div><h2 id="mount-the-iphone">Mount the iPhone</h2>
<p>Consider storing this command <strong>as a shortcut to your desktop for convenience</strong>:</p>
<p><!-- raw HTML omitted --><!-- raw HTML omitted --></p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-sh" data-lang="sh">ifuse /mnt/iphone/
</code></pre></div><h2 id="approve-success">Approve success</h2>
<p><!-- raw HTML omitted --><!-- raw HTML omitted --></p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-sh" data-lang="sh">tree -d -L <span style="color:#ae81ff">1</span> /mnt/iphone/
</code></pre></div><div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-text" data-lang="text">/mnt/iphone/
├── Books
├── CloudAssets
├── DCIM
├── Downloads
├── LoFiCloudAssets
├── MediaAnalysis
├── PhotoData
├── PhotoStreamsData
├── Photos
├── PublicStaging
├── Purchases
├── Radio
├── Recordings
└── iTunes_Control

14 directories
</code></pre></div><h2 id="summary-of-all-commands-to-copy-paste">Summary of all commands to copy/paste</h2>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-sh" data-lang="sh">sudo apt-get update
sudo apt-get upgrade
sudo apt-get install libimobiledevice-utils
sudo apt-get install usbmuxd
sudo apt-get install ifuse
idevicepair pair
sudo mkdir /mnt/iphone/ --verbose
ifuse /mnt/iphone/
tree -d -L <span style="color:#ae81ff">1</span> /mnt/iphone/
</code></pre></div><section class="footnotes" role="doc-endnotes">
<hr>
<ol>
<li id="fn:1" role="doc-endnote">
<p><a href="https://github.com/justinpearson/Raspberry-Pi-for-iPhone-Backup/blob/master/README.md#4-configure-udev-to-run-the-backup-script-upon-the-phone-plug-in-event">https://github.com/justinpearson/Raspberry-Pi-for-iPhone-Backup/blob/master/README.md#4-configure-udev-to-run-the-backup-script-upon-the-phone-plug-in-event</a> <a href="#fnref:1" class="footnote-backref" role="doc-backlink">&#x21a9;&#xfe0e;</a></p>
</li>
</ol>
</section>

      
      


  

  





    </article>
    
      <div class="Divider"></div>
    
  
    <article>
      <header class="Heading">
  <h2 class="Heading-title">
    <a class="Heading-link u-clickable" href="/posts/setup_fujitsu_ix500_scanner_linux/" rel="bookmark">Setup a Fujitsu ix500 scanner on Linux</a>
  </h2>
  
    <time datetime="2020-01-17T18:27:00&#43;01:00">17 January, 2020</time>
  
</header>
      
        <!-- raw HTML omitted -->
<!-- raw HTML omitted -->
<ul>
<li><a href="#install-package">Install package</a></li>
<li><a href="#approve-the-connection">Approve the connection</a></li>
<li><a href="#get-a-list-of-devices">Get a list of devices:</a></li>
<li><a href="#get-a-list-of-all-device-specific-options">Get a list of all device specific options:</a></li>
<li><a href="#scan-a-test-file">Scan a test file</a></li>
<li><a href="#scan-productively">Scan productively</a></li>
<li><a href="#skipping-empty-pages">Skipping empty pages</a></li>
<li><a href="#alias-the-command">Alias the command</a></li>
</ul>
<!-- raw HTML omitted -->
<h2 id="install-package">Install package</h2>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-sh" data-lang="sh">sudo apt install sane-utils -y
</code></pre></div><h2 id="approve-the-connection">Approve the connection</h2>
<p>Enable the scanner by opening the scanner&rsquo;s lid</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-sh" data-lang="sh">sudo sane-find-scanner -q
</code></pre></div><div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-text" data-lang="text">found USB scanner (vendor=0x04c5 [Fujitsu], product=0x132b [ScanSnap iX500]) at libusb:001:007
found USB scanner (vendor=0x0424, product=0x7800) at libusb:001:005
</code></pre></div><h2 id="get-a-list-of-devices">Get a list of devices:</h2>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-sh" data-lang="sh">scanimage --list-devices
</code></pre></div><div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-text" data-lang="text">device `fujitsu:ScanSnap iX500:10443&#39; is a FUJITSU ScanSnap iX500 scanner
</code></pre></div><h2 id="get-a-list-of-all-device-specific-options">Get a list of all device specific options:</h2>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-sh" data-lang="sh">scanimage --device <span style="color:#e6db74">&#39;fujitsu:ScanSnap iX500:10443&#39;</span> --all-options
</code></pre></div><h2 id="scan-a-test-file">Scan a test file</h2>
<p>Scan with default settings to a temporary testfile</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-sh" data-lang="sh">scanimage --format<span style="color:#f92672">=</span>tiff &gt; /tmp/image.tiff
ls --size --block-size<span style="color:#f92672">=</span>M /tmp/image.tiff
</code></pre></div><div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-text" data-lang="text">5M /tmp/image.tiff
</code></pre></div><h2 id="scan-productively">Scan productively</h2>
<p>Mind making this script executable using <code>chmod +x</code>.</p>
<p><!-- raw HTML omitted --><!-- raw HTML omitted -->
<div class="highlight"><div style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4">
<table style="border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 1
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 2
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 3
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 4
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 5
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 6
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 7
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 8
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 9
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">10
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">11
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">12
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">13
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">14
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">15
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">16
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">17
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">18
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">19
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">20
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">21
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">22
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">23
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">24
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">25
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">26
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">27
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">28
</span><span style="display:block;width:100%;background-color:#3c3d38"><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">29
</span></span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">30
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">31
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">32
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">33
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-sh" data-lang="sh"><span style="color:#75715e">#!/bin/bash
</span><span style="color:#75715e"></span><span style="color:#75715e">#Content of ~/scripts/scan.sh</span>
<span style="color:#66d9ef">if</span> <span style="color:#f92672">[</span> $1 -eq <span style="color:#ae81ff">0</span> <span style="color:#f92672">]</span>
<span style="color:#66d9ef">then</span>
    OUT_DIR<span style="color:#f92672">=</span>/tmp
<span style="color:#66d9ef">else</span>
    OUT_DIR<span style="color:#f92672">=</span>$1
<span style="color:#66d9ef">fi</span>
fileNAME<span style="color:#f92672">=</span>scan_<span style="color:#e6db74">`</span>date +%Y-%m-%d-%H%M%S<span style="color:#e6db74">`</span>_

echo <span style="color:#e6db74">&#39;scanning...&#39;</span>
scanimage --verbose<span style="color:#ae81ff">\
</span><span style="color:#ae81ff"></span>          --page-width 221.121<span style="color:#ae81ff">\
</span><span style="color:#ae81ff"></span>          --page-height 876.695<span style="color:#ae81ff">\
</span><span style="color:#ae81ff"></span>          -l 0<span style="color:#ae81ff">\
</span><span style="color:#ae81ff"></span>          -t 0<span style="color:#ae81ff">\
</span><span style="color:#ae81ff"></span>          -x 221.121<span style="color:#ae81ff">\
</span><span style="color:#ae81ff"></span>          -y 876.695 <span style="color:#ae81ff">\
</span><span style="color:#ae81ff"></span>          --ald<span style="color:#f92672">=</span>yes <span style="color:#ae81ff">\
</span><span style="color:#ae81ff"></span>          --overscan On <span style="color:#ae81ff">\
</span><span style="color:#ae81ff"></span>          --prepick<span style="color:#f92672">=</span>On <span style="color:#ae81ff">\
</span><span style="color:#ae81ff"></span>          --mode Gray <span style="color:#ae81ff">\
</span><span style="color:#ae81ff"></span>          --resolution <span style="color:#ae81ff">300</span> <span style="color:#ae81ff">\
</span><span style="color:#ae81ff"></span>          --source <span style="color:#e6db74">&#39;ADF Duplex&#39;</span> <span style="color:#ae81ff">\
</span><span style="color:#ae81ff"></span>          --swcrop<span style="color:#f92672">=</span>yes <span style="color:#ae81ff">\
</span><span style="color:#ae81ff"></span>          --buffermode On <span style="color:#ae81ff">\
</span><span style="color:#ae81ff"></span>          --swdespeck <span style="color:#ae81ff">2</span> <span style="color:#ae81ff">\
</span><span style="color:#ae81ff"></span>          --swdeskew<span style="color:#f92672">=</span>yes <span style="color:#ae81ff">\
</span><span style="display:block;width:100%;background-color:#3c3d38"><span style="color:#ae81ff"></span>          --swskip 20% <span style="color:#ae81ff">\
</span></span><span style="color:#ae81ff"></span>--device <span style="color:#e6db74">&#39;fujitsu:ScanSnap iX500:10443&#39;</span> <span style="color:#ae81ff">\
</span><span style="color:#ae81ff"></span>         --batch<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;</span>$OUT_DIR<span style="color:#e6db74">/</span>$fileNAME<span style="color:#e6db74">%03d.tiff&#34;</span>
printf <span style="color:#e6db74">&#34;Scanned document(s) to:\n\
</span><span style="color:#e6db74">           </span><span style="color:#66d9ef">$(</span>ls --size --block-size<span style="color:#f92672">=</span>M $OUT_DIR/$fileNAME*<span style="color:#66d9ef">)</span><span style="color:#e6db74">&#34;</span></code></pre></td></tr></table>
</div>
</div></p>
<!-- raw HTML omitted -->
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-text" data-lang="text">scanning...
Scanned document(s) to:
           9M /scan_2020-03-22-205607_001.tiff
9M /scan_2020-03-22-205607_002.tiff
</code></pre></div><h2 id="skipping-empty-pages">Skipping empty pages</h2>
<p>Pay attention at the highlighted <code>swskip</code> in the <a href="#code-snippet--scan-script">script</a> above. Lower values e.g. <code>5%</code> almost
never skip empty pages. You get two files (double sided document). Higher values e.g. <code>20%</code> skip
empty pages. You get one file. <strong>Case-specific testing is recommended.</strong></p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-sh" data-lang="sh">scanimage --help | grep swskip --after-context<span style="color:#f92672">=</span><span style="color:#ae81ff">1</span>
</code></pre></div><div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-text" data-lang="text">    --swskip 0..100% (in steps of 0.100006) [0]
        Request driver to discard pages with low percentage of dark pixels
</code></pre></div><h2 id="alias-the-command">Alias the command</h2>
<p>Add this command to your .profile</p>
<p><!-- raw HTML omitted --><!-- raw HTML omitted --></p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-sh" data-lang="sh">alias scan<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;ssh raspi &#39;/home/pi/scripts/scan.sh /media/pi/usb500gb/scan&#39;&#34;</span>
</code></pre></div>
      
      


  

  





    </article>
    
      <div class="Divider"></div>
    
  
    <article>
      <header class="Heading">
  <h2 class="Heading-title">
    <a class="Heading-link u-clickable" href="/posts/screenshots-emacs-org-mode-flameshot/" rel="bookmark">Take screenshots in emacs org mode with flameshot</a>
  </h2>
  
    <time datetime="2019-04-29T15:40:00&#43;02:00">29 April, 2019</time>
  
</header>
      
        <figure>
    <img src="/ox-hugo/out.gif"
         alt="Figure 1: Screencast showing flameshot in action"/> <figcaption>
            <p>Figure 1: Screencast showing flameshot in action</p>
        </figcaption>
</figure>

<h2 id="setup">Setup</h2>
<p>Enable the <code>org</code> layer in your <code>.spacemacs</code> <code>dotspacemacs-configuration-layers</code></p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-elisp" data-lang="elisp">dotspacemacs-configuration-layers
<span style="color:#f92672">&#39;</span>(org)
</code></pre></div><p>Install flameshot</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-sh" data-lang="sh">sudo pacman -S flameshot
</code></pre></div><p>Add the line below to your <code>.spacemacs</code> <code>custom-set-variables</code></p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-elisp" data-lang="elisp">(custom-set-variables
 <span style="color:#f92672">&#39;</span>(org-download-screenshot-method <span style="color:#e6db74">&#34;flameshot gui --raw &gt; %s&#34;</span>))
</code></pre></div><h2 id="usage">Usage</h2>
<ol>
<li>Take your screenshot <code>,</code> <code>i</code> <code>s</code> or <code>M-x org-download-screenshot</code> in org mode</li>
<li>Edit your screenshot on the fly or.. don&rsquo;t</li>
<li>Hit <code>RET</code> to insert your <a href="#orgbffb615">screenshot</a> into your org file</li>
</ol>
<p><!-- raw HTML omitted --><!-- raw HTML omitted --></p>
<figure>
    <img src="/ox-hugo/screenshot-14.png"
         alt="Figure 2: A screenshot taken with flameshot in org mode"/> <figcaption>
            <p>Figure 2: A screenshot taken with flameshot in org mode</p>
        </figcaption>
</figure>


      
      


  

  





    </article>
    
      <div class="Divider"></div>
    
  
    <article>
      <header class="Heading">
  <h2 class="Heading-title">
    <a class="Heading-link u-clickable" href="/posts/writing-letters-in-org-mode/" rel="bookmark">Write a letter in org mode</a>
  </h2>
  
    <time datetime="2019-04-22T20:22:00&#43;02:00">22 April, 2019</time>
  
</header>
      
        <!-- raw HTML omitted -->
<!-- raw HTML omitted -->
<ul>
<li><a href="#goals">Goals</a></li>
<li><a href="#setup">Setup</a></li>
<li><a href="#workflow--spacemacs">Workflow (Spacemacs)</a></li>
</ul>
<!-- raw HTML omitted -->
<h2 id="goals">Goals</h2>
<p><!-- raw HTML omitted --><!-- raw HTML omitted --></p>
<figure>
    <img src="/ox-hugo/screenshot-11.png"
         alt="Figure 1: Printed sample.pdf"/> <figcaption>
            <p>Figure 1: Printed sample.pdf</p>
        </figcaption>
</figure>

<p>In order to get the same printout as in figure <a href="#org8fcfbfc">1</a> above, both <code>includepdf</code>
lines starting at line 37 <a href="#create-the-yasnippets-template">here</a> must be uncommented.</p>
<ol>
<li>Use emacs <sup id="fnref:1"><a href="#fn:1" class="footnote-ref" role="doc-noteref">1</a></sup>org mode</li>
<li>Compose a new letter with a few keystrokes</li>
<li>Manage letters like e-mails</li>
</ol>
<h2 id="setup">Setup</h2>
<h3 id="change-letter-meta-variables-through-a-lco-file">Change letter meta variables through a lco file</h3>
<p>The <sup id="fnref:2"><a href="#fn:2" class="footnote-ref" role="doc-noteref">2</a></sup>koma manual at p.484 displays a nice overview of position
possibilities:</p>
<figure>
    <img src="/ox-hugo/screenshot-13.png"
         alt="Figure 2: Schematic of the pseudo-lengths for a letter"/> <figcaption>
            <p>Figure 2: Schematic of the pseudo-lengths for a letter</p>
        </figcaption>
</figure>

<p>Custom LCO files must be placed in a directory where LaTeX
will find them. On GNU/Linux, this defaults to <code>~/texmf/tex/latex</code>.</p>
<p>Create the folder <code>~/texmf/tex</code></p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-sh" data-lang="sh">mkdir -p ~/texmf/tex
</code></pre></div><p>Create a new file <code>~/texmf/tex/mySN.lco</code> containing these lines:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-latex" data-lang="latex"><span style="color:#66d9ef">\ProvidesFile</span>{mySN.lco}[2019/04/22 my_letter-class-option]
<span style="color:#66d9ef">\LoadLetterOption</span>{SN}
<span style="color:#66d9ef">\let\raggedsignature</span>=<span style="color:#66d9ef">\raggedright</span>
<span style="color:#66d9ef">\setplength</span>{toaddrvpos}{60mm}
<span style="color:#66d9ef">\setplength</span>{backaddrheight}{-3mm}
<span style="color:#66d9ef">\setplength</span>{toaddrheight}{25.5mm}
<span style="color:#66d9ef">\usepackage</span><span style="color:#a6e22e">[german]</span>{babel}
<span style="color:#66d9ef">\endinput</span>
</code></pre></div><p>You can test whether foo.lco is recognized by TeX Live by running the command</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-sh" data-lang="sh">kpsewhich mySN.lco
</code></pre></div><p>After adding a file to the TeX Live path you may have to run</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-sh" data-lang="sh">mktexlsr
</code></pre></div><h3 id="create-the-yasnippets-template">Create the yasnippets template</h3>
<p>Create <em>home/ra</em>.emacs.d/private/snippets/text-mode/exampleLetter containing lines below:</p>
<pre><code class="language-snippet" data-lang="snippet"># -*- mode: snippet -*-
# name:myExampleLetter
# key:,ltr
# --
  #+LCO: mySN
  #+OPTIONS: backaddress:t email:nil
  #+OPTIONS: after-closing-order:(after_closing ps encl cc)
  #+OPTIONS: after-letter-order:(after_letter)
  #+OPTIONS: foldmarks:nil phone:nil place:t special-headings:nil subject:t
  #+OPTIONS: title-subject:nil url:nil location:t title:nil

  #+LATEX_CLASS: default-koma-letter
  #+LATEX_HEADER: \setkomavar{signature}{\includegraphics[height=1cm]{/home/ra/Downloads/signature.pdf}\\\\\usekomavar{fromname}}
  #+LaTeX_HEADER: \usepackage{pdfpages}

  #+AUTHOR: Sender Name
  #+FROM_ADDRESS: Acmestreet 1, 5555 Footown
  #+PHONE_NUMBER: 0123456789
  #+URL: example.org
  #+EMAIL: foo@bar.com
  #+TO_ADDRESS: ${1:ReceiverInc}\\\ ${2:JohnDoe}\\\ ${3:SomeStreet}\\\ ${4:ZipTown}\\\Mittelerde
  #+PLACE: MyTown
  #+SUBJECT: ${5:MySubject}
  #+OPENING: ${6:Dear John}
  #+CLOSING: With best regards
  ${0:MyText}
*** PS                                                                   :ps:noexport:
    PS: I must remove the :noexport: tag to display this line in the exported pdf
*** CC                                                                   :cc:
    Jane &amp; Alice
*** ENCL                                                               :encl:
    - A map
    - Another map
*** Included files                                             :after_letter:
    #+BEGIN_EXPORT latex
    % Uncomment line below to include other pdf files
    %\includepdf[pages=-]{/home/ra/Downloads/Map.pdf} %must use absolute path
    %\includepdf[pages=-]{/home/ra/Downloads/OtherMap.pdf} %must use absolute path
    #+END_EXPORT</code></pre>
<h2 id="workflow--spacemacs">Workflow (Spacemacs)</h2>
<ol>
<li>Create a new file hitting <code>SPC f f</code></li>
<li>Enter the filename e.g. sample.org <code>RET</code></li>
<li>Expand the <a href="#create-the-yasnippets-template">template</a> we created before hitting <code>,ltr TAB</code></li>
<li>Toggle through the fields hitting <code>TAB</code></li>
<li>Export the pdf hitting <code>, e e k o</code></li>
</ol>
<figure>
    <img src="/ox-hugo/screenshot-12.png"/> 
</figure>

<section class="footnotes" role="doc-endnotes">
<hr>
<ol>
<li id="fn:1" role="doc-endnote">
<p><a href="https://orgmode.org/worg/exporters/koma-letter-export.html#org1fb055f">https://orgmode.org/worg/exporters/koma-letter-export.html#org1fb055f</a> <a href="#fnref:1" class="footnote-backref" role="doc-backlink">&#x21a9;&#xfe0e;</a></p>
</li>
<li id="fn:2" role="doc-endnote">
<p><a href="http://texdoc.net/texmf-dist/doc/latex/koma-script/scrguien.pdf">http://texdoc.net/texmf-dist/doc/latex/koma-script/scrguien.pdf</a> <a href="#fnref:2" class="footnote-backref" role="doc-backlink">&#x21a9;&#xfe0e;</a></p>
</li>
</ol>
</section>

      
      


  

  





    </article>
    
      <div class="Divider"></div>
    
  
    <article>
      <header class="Heading">
  <h2 class="Heading-title">
    <a class="Heading-link u-clickable" href="/posts/howto-ox-hugo-github-pages/" rel="bookmark">Blog in org mode with ox-hugo and github pages</a>
  </h2>
  
    <time datetime="2019-04-16T19:52:00&#43;02:00">16 April, 2019</time>
  
</header>
      
        <!-- raw HTML omitted -->
<!-- raw HTML omitted -->
<ul>
<li><a href="#setup-ox-hugo">Setup ox-hugo</a></li>
<li><a href="#create-a-new-github-repo-via-web-front-end">Create a new github repo via web front-end</a></li>
<li><a href="#clone-the-new-repository">Clone the new repository</a></li>
<li><a href="#setup-hugo-in-our-new-repository">Setup Hugo in our new repository</a></li>
<li><a href="#create-the-new-hugo-site">Create the new hugo site</a></li>
<li><a href="#download-a-theme-and-add-it-as-git-sub-module">Download a theme and add it as git sub-module</a></li>
<li><a href="#create-the-org-content-folder">Create the org content folder</a></li>
<li><a href="#create-a-minimal-org-file-web-page">Create a minimal org file / web page</a></li>
<li><a href="#start-the-hugo-server">Start the hugo server</a></li>
<li><a href="#browse-to-our-local-site">Browse to our local site</a></li>
<li><a href="#export-our-org-file-to-hugo">Export our org file to hugo</a></li>
<li><a href="#note-how-hugo-immediately-rebuilds-the-site">Note how hugo immediately rebuilds the site</a></li>
<li><a href="#check-the-browser">Check the browser</a></li>
<li><a href="#recheck-what-has-been-created">Recheck what has been created</a></li>
<li><a href="#publish-to-github-pages">Publish to Github pages</a></li>
<li><a href="#visit-https-ridaayed-dot-github-dot-io">Visit https://RidaAyed.github.io</a></li>
<li><a href="#what-about-speed">What about speed?</a></li>
<li><a href="#using-prodigy-for-hugo-auto-build-on-saving-the-org-file">Using prodigy for hugo auto build on saving the org file</a></li>
</ul>
<!-- raw HTML omitted -->
<h2 id="setup-ox-hugo">Setup ox-hugo</h2>
<p><a href="https://ox-hugo.scripter.co/doc/usage/">https://ox-hugo.scripter.co/doc/usage/</a></p>
<p>Add these lines to <code>.spacemacs</code></p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-elisp" data-lang="elisp">dotspacemacs-additional-packages <span style="color:#f92672">&#39;</span>(
                                   ox-hugo)
</code></pre></div><div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-elisp" data-lang="elisp">(defun dotspacemacs/user-config ()
  (use-package ox-hugo
    :ensure <span style="color:#66d9ef">t</span>          <span style="color:#75715e">;Auto-install the package from Melpa (optional)</span>
    :after ox))
</code></pre></div><h2 id="create-a-new-github-repo-via-web-front-end">Create a new github repo via web front-end</h2>
<ol>
<li>Login to <a href="https://github.com/new">https://github.com/new</a></li>
<li>Enter RidaAyed.github.io</li>
<li>Leave other fields</li>
</ol>
<h2 id="clone-the-new-repository">Clone the new repository</h2>
<ol>
<li><code>m-x magit-clone</code></li>
<li><a href="mailto:git@github.com">git@github.com</a>:RidaAyed/RidaAyed.github.io.git</li>
<li><code>RET</code></li>
</ol>
<h2 id="setup-hugo-in-our-new-repository">Setup Hugo in our new repository</h2>
<h2 id="create-the-new-hugo-site">Create the new hugo site</h2>
<p><a href="https://www.kengrimes.com/ox-hugo-tutorial/">https://www.kengrimes.com/ox-hugo-tutorial/</a></p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-sh" data-lang="sh">hugo new site --force /home/ra/RidaAyed.github.io
</code></pre></div><h2 id="download-a-theme-and-add-it-as-git-sub-module">Download a theme and add it as git sub-module</h2>
<p><a href="https://gohugo.io/getting-started/quick-start/#step-3-add-a-theme">https://gohugo.io/getting-started/quick-start/#step-3-add-a-theme</a></p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-sh" data-lang="sh">cd /home/ra/RidaAyed.github.io
git submodule add https://github.com/budparr/gohugo-theme-ananke.git themes/ananke
</code></pre></div><p>Check our current config.toml</p>
<p><!-- raw HTML omitted --><!-- raw HTML omitted --></p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-sh" data-lang="sh">cat /home/ra/src/RidaAyed.github.io/config.toml
</code></pre></div><p>Add the Ananke theme to our config.toml</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-sh" data-lang="sh">cd /home/ra/RidaAyed.github.io
echo <span style="color:#e6db74">&#39;theme = &#34;ananke&#34;&#39;</span> &gt;&gt; config.toml
</code></pre></div><p>Recheck our current config.toml</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-sh" data-lang="sh">cat /home/ra/src/RidaAyed.github.io/config.toml
</code></pre></div><h2 id="create-the-org-content-folder">Create the org content folder</h2>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-sh" data-lang="sh">cd /home/ra/RidaAyed.github.io
mkdir content-org
</code></pre></div><h2 id="create-a-minimal-org-file-web-page">Create a minimal <sup id="fnref:1"><a href="#fn:1" class="footnote-ref" role="doc-noteref">1</a></sup> org file / web page</h2>
<p><code>#+hugo_base_dir:</code> must be followed by two dots <code>..</code> since our file resides in the subfolder <code>org-content</code></p>
<div class="highlight"><div style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4">
<table style="border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code><span style="display:block;width:100%;background-color:#3c3d38"><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1
</span></span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">2
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">3
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">4
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">5
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">6
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">7
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-org" data-lang="org"><span style="display:block;width:100%;background-color:#3c3d38"><span style="color:#75715e">#+hugo_base_dir</span><span style="color:#75715e">: ..</span>
</span>
*<span style="font-weight:bold"> My post</span>
<span style="color:#75715e">:PROPERTIES:
</span><span style="color:#75715e"></span><span style="color:#75715e">:EXPORT_FILE_NAME: my-post
</span><span style="color:#75715e"></span><span style="color:#75715e">:END:</span>
This gets created in <span style="color:#a6e22e">~&lt;HUGO_BASE_DIR&gt;/content/posts/~</span>.</code></pre></td></tr></table>
</div>
</div>
<h2 id="start-the-hugo-server">Start the hugo server</h2>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-sh" data-lang="sh">cd /home/ra/RidaAyed.github.io
hugo server -D --navigateToChanged
</code></pre></div><figure>
    <img src="/ox-hugo/screenshot-02.png"
         alt="Figure 1: Screenshot - $ hugo"/> <figcaption>
            <p>Figure 1: Screenshot - $ hugo</p>
        </figcaption>
</figure>

<h2 id="browse-to-our-local-site">Browse to our local site</h2>
<p>Visit <a href="http://localhost:1313/">http://localhost:1313/</a></p>
<figure>
    <img src="/ox-hugo/screenshot-03.png"
         alt="Figure 2: Screenshot - localhost"/> <figcaption>
            <p>Figure 2: Screenshot - localhost</p>
        </figcaption>
</figure>

<h2 id="export-our-org-file-to-hugo">Export our org file to hugo</h2>
<p><code>M-x org-export-dispatch</code></p>
<figure>
    <img src="/ox-hugo/screenshot-09.png"
         alt="Figure 3: Screenshot - org-export-dispatch"/> <figcaption>
            <p>Figure 3: Screenshot - org-export-dispatch</p>
        </figcaption>
</figure>

<h2 id="note-how-hugo-immediately-rebuilds-the-site">Note how hugo immediately rebuilds the site</h2>
<figure>
    <img src="/ox-hugo/screenshot-05.png"
         alt="Figure 4: Screenshot - Hugo instant rebuilding changes"/> <figcaption>
            <p>Figure 4: Screenshot - Hugo instant rebuilding changes</p>
        </figcaption>
</figure>

<p>Remark: The second change was due to adding the second dot as mentioned here</p>
<h2 id="check-the-browser">Check the browser</h2>
<figure>
    <img src="/ox-hugo/screenshot-04.png"
         alt="Figure 5: Screenshot - Revisiting localhost"/> <figcaption>
            <p>Figure 5: Screenshot - Revisiting localhost</p>
        </figcaption>
</figure>

<h2 id="recheck-what-has-been-created">Recheck what has been created</h2>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-sh" data-lang="sh">tree /home/ra/RidaAyed.github.io -D -L <span style="color:#ae81ff">2</span>
</code></pre></div><div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-text" data-lang="text">/home/ra/RidaAyed.github.io
├── [Apr 14 15:52]  archetypes
│   └── [Apr 14 15:52]  default.md
├── [Apr 16 19:04]  config.toml
├── [Apr 14 17:10]  content
│   └── [Apr 16 19:11]  posts
├── [Apr 16 19:11]  content-org
│   ├── [Apr 16 19:11]  blog.org
│   ├── [Apr 15 20:42]  images
│   └── [Apr 16 19:04]  sample.org
├── [Apr 14 15:52]  data
├── [Apr 16 19:04]  deploy.sh
├── [Apr 14 15:52]  layouts
├── [Apr 16 18:30]  public
├── [Apr 14 16:27]  resources
│   └── [Apr 14 16:27]  _gen
├── [Apr 14 23:29]  static
│   └── [Apr 15 20:42]  ox-hugo
└── [Apr 16 19:13]  themes
    ├── [Apr 14 15:59]  ananke
    └── [Apr 15 21:20]  hugo-coder

15 directories, 5 files
</code></pre></div><h2 id="publish-to-github-pages">Publish to Github pages</h2>
<p>In case you followed
<a href="https://gohugo.io/hosting-and-deployment/hosting-on-github/#step-by-step-instructions">https://gohugo.io/hosting-and-deployment/hosting-on-github/#step-by-step-instructions</a>.
I missed the <code>/public</code> folder from step 4.</p>
<p><strong>The <code>public</code> folder will not be created</strong>, if <code>$ hugo</code> is executed with the
<code>server</code> option. Simply run <code>$ hugo</code> as shown at line 2:</p>
<div class="highlight"><div style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4">
<table style="border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">2
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-sh" data-lang="sh">cd /home/ra/RidaAyed.github.io
hugo</code></pre></td></tr></table>
</div>
</div>
<p>Following the next step from the step by step instruction</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-sh" data-lang="sh">cd /home/ra/RidaAyed.github.io
git submodule add -b master git@github.com:RidaAyed/RidaAyed.github.io.git public
</code></pre></div><p>By <strong>not following the step-by-step instructions</strong> whom propose creating <strong>two</strong>
repositories results in</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-text" data-lang="text">Cloning into &#39;/home/ra/src/RidaAyed.github.io/public&#39;...
warning: You appear to have cloned an empty repository.
fatal: &#39;origin/master&#39; is not a commit and a branch &#39;master&#39; cannot be created from it
</code></pre></div><p>Let&rsquo;s create another git branch</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-sh" data-lang="sh">cd /home/ra/RidaAyed.github.io
git checkout -b source
</code></pre></div><p>Trying again</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-sh" data-lang="sh">cd /home/ra/RidaAyed.github.io
git submodule add -b master git@github.com:RidaAyed/RidaAyed.github.io.git public
</code></pre></div><p>Better</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-text" data-lang="text">Adding existing repo at &#39;RidaAyed.github.io/public&#39; to the index
</code></pre></div><p>Create a script <code>deploy.sh</code> to deploy and publish to github</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-sh" data-lang="sh">echo -e <span style="color:#e6db74">&#34;\033[0;32mDeploying updates to GitHub...\033[0m&#34;</span>

<span style="color:#75715e"># Build the project.</span>
hugo <span style="color:#75715e"># if using a theme, replace with `hugo -t &lt;YOURTHEME&gt;`</span>

<span style="color:#75715e"># Go To Public folder</span>
cd public
<span style="color:#75715e"># Add changes to git.</span>
git add .

<span style="color:#75715e"># Commit changes.</span>
msg<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;rebuilding site `date`&#34;</span>
<span style="color:#66d9ef">if</span> <span style="color:#f92672">[</span> $# -eq <span style="color:#ae81ff">1</span> <span style="color:#f92672">]</span>
  <span style="color:#66d9ef">then</span> msg<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;</span>$1<span style="color:#e6db74">&#34;</span>
<span style="color:#66d9ef">fi</span>
git commit -m <span style="color:#e6db74">&#34;</span>$msg<span style="color:#e6db74">&#34;</span>

<span style="color:#75715e"># Push source and build repos.</span>
git push origin master

<span style="color:#75715e"># Come Back up to the Project Root</span>
cd ..
</code></pre></div><div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-sh" data-lang="sh">sudo chmod +x /home/ra/src/RidaAyed.github.io/deploy.sh
</code></pre></div><div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-sh" data-lang="sh">cd /home/ra/RidaAyed.github.io
./deploy.sh
</code></pre></div><h2 id="visit-https-ridaayed-dot-github-dot-io">Visit <a href="https://ridaayed.github.io">https://ridaayed.github.io</a></h2>
<figure>
    <img src="/ox-hugo/screenshot-07.png"
         alt="Figure 6: Screenshot - https://ridaayed.github.io"/> <figcaption>
            <p>Figure 6: Screenshot - <a href="https://ridaayed.github.io">https://ridaayed.github.io</a></p>
        </figcaption>
</figure>

<h2 id="what-about-speed">What about speed?</h2>
<figure>
    <img src="/ox-hugo/screenshot-08.png"
         alt="Figure 7: Screenshot - of PageSpeedInsights"/> <figcaption>
            <p>Figure 7: Screenshot - of PageSpeedInsights</p>
        </figcaption>
</figure>

<h2 id="using-prodigy-for-hugo-auto-build-on-saving-the-org-file">Using prodigy for hugo auto build on saving the org file</h2>
<p>Since you&rsquo;re lazy and event don&rsquo;t want to bother to <a href="#start-the-hugo-server">Start the hugo server</a>
, you&rsquo;ll delegate this to prodigy:</p>
<ul>
<li>Add the <code>prodigy</code> <sup id="fnref:2"><a href="#fn:2" class="footnote-ref" role="doc-noteref">2</a></sup>layer</li>
<li>Add this section at the end of <code>.spacemacs</code>:</li>
</ul>
<!-- raw HTML omitted -->
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-elisp" data-lang="elisp">(prodigy-define-service
 :name <span style="color:#e6db74">&#34;Hugo Personal Blog&#34;</span>
 :command <span style="color:#e6db74">&#34;/usr/bin/hugo&#34;</span>
 :args <span style="color:#f92672">&#39;</span>(<span style="color:#e6db74">&#34;server&#34;</span> <span style="color:#e6db74">&#34;-D&#34;</span> <span style="color:#e6db74">&#34;--navigateToChanged&#34;</span> <span style="color:#e6db74">&#34;-t&#34;</span> <span style="color:#e6db74">&#34;hugo-coder&#34;</span>)
 :cwd <span style="color:#e6db74">&#34;~/RidaAyed.github.io&#34;</span>
 :tags <span style="color:#f92672">&#39;</span>(personal)
 :stop-signal <span style="color:#e6db74">&#39;sigkill</span>
 :kill-process-buffer-on-stop <span style="color:#66d9ef">t</span>)
</code></pre></div><ul>
<li>Start prodigy to take over hugo <code>SPC a S r</code></li>
</ul>
<figure>
    <img src="/ox-hugo/out-4.gif"/> 
</figure>

<section class="footnotes" role="doc-endnotes">
<hr>
<ol>
<li id="fn:1" role="doc-endnote">
<p><a href="https://ox-hugo.scripter.co/doc/hugo-section/">https://ox-hugo.scripter.co/doc/hugo-section/</a> <a href="#fnref:1" class="footnote-backref" role="doc-backlink">&#x21a9;&#xfe0e;</a></p>
</li>
<li id="fn:2" role="doc-endnote">
<p><a href="https://github.com/syl20bnr/spacemacs/tree/master/layers/%2Btools/prodigy">https://github.com/syl20bnr/spacemacs/tree/master/layers/%2Btools/prodigy</a> <a href="#fnref:2" class="footnote-backref" role="doc-backlink">&#x21a9;&#xfe0e;</a></p>
</li>
</ol>
</section>

      
      


  

  





    </article>
    
      <div class="Divider"></div>
    
  

  




      </div>
    </div>
  </main>
  
</body>

</html>
